<div class="row">
  <div class="col-lg-8 col-md-10 offset-lg-2 offset-md-1">
    <h2 class="page-header text-center">Write</h2>

    <div class="alert show" [ngClass]="messageClass" [class.d-none]="!message" role="alert">
      {{ message }}
      <button type="button" class="close" aria-label="Close" (click)="dismissAlert()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <form [formGroup]="writeForm" (submit)="onWriteSubmit()">
      <div class="form-group">
        <label for="title">Title</label>
        <div [ngClass]="{'has-error': writeForm.controls.title.dirty && writeForm.controls.title.errors}">
          <input class="form-control" type="text" name="title" formControlName="title" autocomplete="off"/>
          
          <ul class="help-block validation-feedback">
            <li *ngIf="writeForm.controls.title.dirty && writeForm.controls.title.errors?.required" class="message-error">This field is required.</li>
            <li *ngIf="writeForm.controls.title.dirty && (writeForm.controls.title.errors?.minlength || writeForm.controls.title.errors?.maxlength)" class="message-error">Minimum characters: 5, Maximum characters: 50</li>
            <li *ngIf="writeForm.controls.title.dirty && writeForm.controls.title.errors?.validateTitle" class="message-error">Title must not have any special characters</li>
          </ul>
        </div>
      </div>
    
      <div class="form-group">
        <label for="body">Body</label>
        <div class="md-editor">
          <div class="md-header">
            <nav class="md-tabs">
              <button id="md-tab-write" (click)="showWrite()" class="md-tab" [ngClass]="{'md-tab-active': tab_write_active}">Write</button>
              <button id="md-tab-preview" (click)="showPreview()" class="md-tab" [ngClass]="{'md-tab-active': tab_preview_active}">Preview</button>
            </nav>
            <ul id="md-controls" class="md-controls" [ngClass]="{'md-show': tab_write_active}">
              <div class="md-control-group">
                <li class="md-control md-tooltip" aria-label="Add header text" (click)="makeHeader(mdContent)"><svg viewBox="0 0 18 16" version="1.1" width="18" height="16"><path fill-rule="evenodd" d="M13.62 9.08L12.1 3.66h-.06l-1.5 5.42h3.08zM5.7 10.13S4.68 6.52 4.53 6.02h-.08l-1.13 4.11H5.7zM17.31 14h-2.25l-.95-3.25h-4.07L9.09 14H6.84l-.69-2.33H2.87L2.17 14H0l3.3-9.59h2.5l2.17 6.34L10.86 2h2.52l3.94 12h-.01z"></path></svg></li>
                <li class="md-control md-tooltip" aria-label="Add bold text" (click)="makeBold(mdContent)"><svg class="octicon octicon-bold" viewBox="0 0 10 16" version="1.1" width="10" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M1 2h3.83c2.48 0 4.3.75 4.3 2.95 0 1.14-.63 2.23-1.67 2.61v.06c1.33.3 2.3 1.23 2.3 2.86 0 2.39-1.97 3.52-4.61 3.52H1V2zm3.66 4.95c1.67 0 2.38-.66 2.38-1.69 0-1.17-.78-1.61-2.34-1.61H3.13v3.3h1.53zm.27 5.39c1.77 0 2.75-.64 2.75-1.98 0-1.27-.95-1.81-2.75-1.81h-1.8v3.8h1.8v-.01z"></path></svg></li>
                <li class="md-control md-tooltip" aria-label="Add italic text" (click)="makeItalic(mdContent)"><svg class="octicon octicon-italic" viewBox="0 0 6 16" version="1.1" width="6" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M2.81 5h1.98L3 14H1l1.81-9zm.36-2.7c0-.7.58-1.3 1.33-1.3.56 0 1.13.38 1.13 1.03 0 .75-.59 1.3-1.33 1.3-.58 0-1.13-.38-1.13-1.03z"></path></svg></li>    
              </div>
              <div class="md-control-group">
                <li class="md-control md-tooltip" aria-label="Insert a quote" (click)="makeQuote(mdContent)"><svg class="octicon octicon-quote" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M6.16 3.5C3.73 5.06 2.55 6.67 2.55 9.36c.16-.05.3-.05.44-.05 1.27 0 2.5.86 2.5 2.41 0 1.61-1.03 2.61-2.5 2.61-1.9 0-2.99-1.52-2.99-4.25 0-3.8 1.75-6.53 5.02-8.42L6.16 3.5zm7 0c-2.43 1.56-3.61 3.17-3.61 5.86.16-.05.3-.05.44-.05 1.27 0 2.5.86 2.5 2.41 0 1.61-1.03 2.61-2.5 2.61-1.89 0-2.98-1.52-2.98-4.25 0-3.8 1.75-6.53 5.02-8.42l1.14 1.84h-.01z"></path></svg></li>
                <li class="md-control md-tooltip" aria-label="Inster code" (click)="makeCode(mdContent)"><svg class="octicon octicon-code" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"></path></svg></li>
                <li class="md-control md-tooltip" aria-label="Add a link" (click)="makeLink(mdContent)"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></li>    
              </div>
              <div class="md-control-group">
                <li class="md-control md-tooltip" aria-label="Add a bulleted list" (click)="makeUnorderedList(mdContent)"><svg class="octicon octicon-list-unordered" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M2 13c0 .59 0 1-.59 1H.59C0 14 0 13.59 0 13c0-.59 0-1 .59-1h.81c.59 0 .59.41.59 1H2zm2.59-9h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1H4.59C4 2 4 2.41 4 3c0 .59 0 1 .59 1zM1.41 7H.59C0 7 0 7.41 0 8c0 .59 0 1 .59 1h.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01zm0-5H.59C0 2 0 2.41 0 3c0 .59 0 1 .59 1h.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01zm10 5H4.59C4 7 4 7.41 4 8c0 .59 0 1 .59 1h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01zm0 5H4.59C4 12 4 12.41 4 13c0 .59 0 1 .59 1h6.81c.59 0 .59-.41.59-1 0-.59 0-1-.59-1h.01z"></path></svg></li>
                <li class="md-control md-tooltip" aria-label="Add a numbered list" (click)="makeOrderedList(mdContent)"><svg class="octicon octicon-list-ordered" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 12.99c0 .589 0 .998-.59.998H4.597c-.59 0-.59-.41-.59-.999 0-.59 0-.999.59-.999H11.4c.59 0 .59.41.59 1H12zM4.596 3.996H11.4c.59 0 .59-.41.59-1 0-.589 0-.999-.59-.999H4.596c-.59 0-.59.41-.59 1 0 .589 0 .999.59.999zM11.4 6.994H4.596c-.59 0-.59.41-.59 1 0 .589 0 .999.59.999H11.4c.59 0 .59-.41.59-1 0-.59 0-.999-.59-.999zM2.008 1h-.72C.99 1.19.71 1.25.26 1.34V2h.75v2.138H.17v.859h2.837v-.86h-.999V1zm.25 8.123c-.17 0-.45.03-.66.06.53-.56 1.14-1.249 1.14-1.888-.02-.78-.56-1.299-1.36-1.299-.589 0-.968.2-1.378.64l.58.579c.19-.19.38-.38.639-.38.28 0 .48.16.48.52 0 .53-.77 1.199-1.699 2.058v.58h2.998l-.09-.88h-.66l.01.01zm-.08 3.777v-.03c.44-.19.64-.47.64-.859 0-.7-.56-1.11-1.44-1.11-.479 0-.888.19-1.278.52l.55.64c.25-.2.44-.31.689-.31.27 0 .42.13.42.36 0 .27-.2.44-.86.44v.749c.83 0 .98.17.98.47 0 .25-.23.38-.58.38-.28 0-.56-.14-.81-.38l-.479.659c.3.36.77.56 1.409.56.83 0 1.529-.41 1.529-1.16 0-.5-.31-.809-.77-.939v.01z"></path></svg></li>
                <li class="md-control md-tooltip" aria-label="Add a task list" (click)="makeTaskList(mdContent)"><svg class="octicon octicon-tasklist" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M15.41 9H7.59C7 9 7 8.59 7 8c0-.59 0-1 .59-1h7.81c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zM9.59 4C9 4 9 3.59 9 3c0-.59 0-1 .59-1h5.81c.59 0 .59.41.59 1 0 .59 0 1-.59 1H9.59zM0 3.91l1.41-1.3L3 4.2 7.09 0 8.5 1.41 3 6.91l-3-3zM7.59 12h7.81c.59 0 .59.41.59 1 0 .59 0 1-.59 1H7.59C7 14 7 13.59 7 13c0-.59 0-1 .59-1z"></path></svg></li>    
              </div>
            </ul>
          </div>
    
          <div id="md-body-write" class="md-body md-show" [ngClass]="{'md-show': tab_write_active}">
            <div [ngClass]="{'has-error': writeForm.controls.body.dirty && writeForm.controls.body.errors}">
              <textarea id="md-content" #mdContent rows="15" class="form-control" type="text" name="body" formControlName="body" spellcheck="false"></textarea>
              <ul class="help-block validation-feedback">
                <li *ngIf="writeForm.controls.body.dirty && writeForm.controls.body.errors?.required" class="message-error">This field is required.</li>
                <li *ngIf="writeForm.controls.body.dirty && (writeForm.controls.body.errors?.minlength || writeForm.controls.body.errors?.maxlength)" class="message-error">Minimum characters: 5, Maximum characters: 500</li>
              </ul>
            </div>
          </div>
          <div id="md-body-preview" class="md-body" [ngClass]="{'md-show': tab_preview_active}">
            <div id="md-preview"></div>
          </div>
    
          <div class="md-footer">
            Markdown editor
          </div>
        </div>
      </div>
      
      <input [disabled]="!writeForm.valid || processing" class="btn btn-primary btn-block" type="submit" value="Post" />
    </form>
  </div>
</div>